(function(y){"use strict";var M=Object.defineProperty,p=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,w=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))b.call(t,n)&&w(e,n,t[n]);if(p)for(var n of p(t))O.call(t,n)&&w(e,n,t[n]);return e};const v=(e="always")=>e==="always"?{playMode:e,hideOverflow:!1,timing:{duration:2*1e3,iterations:1/0},glitchTimeSpan:{start:.5,end:.7},shake:{velocity:15,amplitudeX:.4,amplitudeY:.4},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}:{playMode:e,hideOverflow:!1,timing:{duration:150,iterations:1},glitchTimeSpan:{start:0,end:1},shake:{velocity:15,amplitudeX:.05,amplitudeY:.05},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}},d=(e,t)=>{let n=0;if(e.glitchTimeSpan){const l=e.glitchTimeSpan.start,o=e.glitchTimeSpan.end;if(t<l||t>o)return 0;const r=l+(o-l)/2;t<r?n=(t-l)/(r-l):n=(o-t)/(o-r)}else n=1;return(Math.random()-.5)*2*n},A=({minHeight:e,maxHeight:t,minWidth:n,maxWidth:a})=>{const l=Math.floor(Math.random()*((t-e)*100+1))+e*100,o=Math.floor(Math.random()*((a-n)*100+1))+n*100,r=Math.floor(Math.random()*(100-l)),h=Math.floor(Math.random()*(100-o));return{top:r,left:h,height:l,width:o}},P=({top:e,left:t,height:n,width:a})=>{const l=`${t+a}% ${e}%`,o=`${t+a}% ${e+n}%`,r=`${t}% ${e+n}%`,h=`${t}% ${e}%`;return`polygon(${l}, ${o}, ${r}, ${h})`},f=e=>({easing:`steps(${e}, jump-start)`}),S=e=>{if(!e.slice)throw new Error("Slice are not enabled");const t=Math.floor(e.slice.velocity*e.timing.duration/1e3)+1,n=[];for(let a=0;a<t;++a){const l=A({minHeight:e.slice.minHeight,maxHeight:e.slice.maxHeight,minWidth:1,maxWidth:1}),o=d(e,a/t)*30,r={};r.transform=`translate3d(${o}%, 0, 0)`,r.clipPath=P(l),e.slice.hueRotate&&(r.filter=`hue-rotate(${Math.floor(d(e,a/t)*360)}deg)`),n.push(r)}return{steps:n,timing:m(m({},f(t)),e.timing)}},C=e=>{if(!e.shake)return{steps:[],timing:f(1)};const t=Math.floor(e.shake.velocity*e.timing.duration/1e3)+1,n=[];for(let a=0;a<t;++a){const l=d(e,a/t)*e.shake.amplitudeX*100,o=d(e,a/t)*e.shake.amplitudeY*100,r={};r.transform=`translate3d(${l}%, ${o}%, 0)`,n.push(r)}return{steps:n,timing:m(m({},f(t)),e.timing)}},$=e=>{const t=[C(e)];if(e.slice)for(let n=0;n<e.slice.count;++n)t.push(S(e));return t};function _(...e){const t=n=>n&&typeof n=="object";return e.reduce((n,a)=>(Object.keys(a).forEach(l=>{const o=n[l],r=a[l];if(Array.isArray(o)&&Array.isArray(r)){n[l]=o.concat(...r);return}if(t(o)&&t(r)){n[l]=_(o,r);return}r!==void 0&&(n[l]=r)}),n),{})}const R={glitch:(e=".powerglitch",t={})=>{var n;const a=_(v(t.playMode),t);let l=[];if(typeof e=="string"){const r=document.querySelectorAll(e);if(!r.length)throw new Error(`Could not find any element with selector ${e}`);l=Array.from(r)}else l=[e];const o=$(a);for(const r of l){const h=!!r.dataset.glitched;let i;if(h){for(i=r.parentElement;i.children.length>1;)i.removeChild(i.children[1]);i.firstChild.getAnimations().forEach(c=>c.cancel()),console.log("recycled container",i)}else i=document.createElement("div"),i.style.display=getComputedStyle(r).getPropertyValue("display"),i.style.position="relative";a.hideOverflow&&(i.style.overflow="hidden"),a.html&&(r.innerHTML=a.html),h||((n=r.parentElement)==null||n.insertBefore(i,r),i.prepend(r));const s=r.cloneNode(!0);s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.width="100%",s.style.height="100%",s.style.userSelect="none",s.style.pointerEvents="none";for(let c=0;c<o.length-1;++c){const u=s.cloneNode(!0);i.appendChild(u)}const g=()=>{o.forEach((c,u)=>i.children[u].animate(c.steps,c.timing))},E=()=>{o.forEach((c,u)=>i.children[u].getAnimations().map(k=>k.cancel()))};switch(a.playMode){case"always":g(),i.onmouseenter=null,i.onmouseleave=null;break;case"hover":i.onmouseenter=g,i.onmouseleave=E,i.onclick=null;break;case"click":i.onmouseenter=null,i.onmouseleave=null,i.onclick=()=>{E(),g()};break}r.dataset.glitched="1"}},generateLayers:$,getDefaultOptions:v};y.PowerGlitch=R,Object.defineProperty(y,"__esModule",{value:!0})})(this.window=this.window||{});
