(function(f){"use strict";var _=Object.defineProperty,g=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,y=(t,e,n)=>e in t?_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p=(t,e)=>{for(var n in e||(e={}))M.call(e,n)&&y(t,n,e[n]);if(g)for(var n of g(e))b.call(e,n)&&y(t,n,e[n]);return t};const v=(t="always")=>({playMode:t,hideOverflow:!1,timing:t==="always"?{duration:2*1e3,iterations:1/0}:{duration:250,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),w=(t,e)=>{if(!t.glitchTimeSpan)return 1;const n=t.glitchTimeSpan.start,a=t.glitchTimeSpan.end;if(e<n||e>a)return 0;const i=n+(a-n)/2;return e<i?(e-n)/(i-n):(a-e)/(a-i)},u=(t,e)=>(Math.random()-.5)*2*w(t,e),A=({minHeight:t,maxHeight:e,minWidth:n,maxWidth:a})=>{const i=Math.floor(Math.random()*((e-t)*100+1))+t*100,l=Math.floor(Math.random()*((a-n)*100+1))+n*100,r=Math.floor(Math.random()*(100-i)),s=Math.floor(Math.random()*(100-l));return{top:r,left:s,height:i,width:l}},G=({top:t,left:e,height:n,width:a})=>{const i=`${e+a}% ${t}%`,l=`${e+a}% ${t+n}%`,r=`${e}% ${t+n}%`,s=`${e}% ${t}%`;return`polygon(${i},${l},${r},${s})`},k=t=>{const e=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,n=[];for(let a=0;a<e;++a){if(w(t,a/e)===0){n.push({opacity:"0",transform:"",clipPath:"unset"});continue}const i=A({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1}),l=u(t,a/e)*30,r={opacity:"1",transform:`translate3d(${l}%,0,0)`,clipPath:G(i)};t.slice.hueRotate&&(r.filter=`hue-rotate(${Math.floor(u(t,a/e)*360)}deg)`),n.push(r)}return{steps:n,timing:p({easing:`steps(${e},jump-start)`},t.timing)}},P=t=>{if(!t.shake)return{steps:[],timing:{}};const e=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,n=[];for(let a=0;a<e;++a){const i=u(t,a/e)*t.shake.amplitudeX*100,l=u(t,a/e)*t.shake.amplitudeY*100,r={};r.transform=`translate3d(${i}%,${l}%,0)`,n.push(r)}return{steps:n,timing:p({easing:`steps(${e},jump-start)`},t.timing)}},E=t=>{const e=[P(t)];if(t.slice)for(let n=0;n<t.slice.count;++n)e.push(k(t));return e},$=(...t)=>{const e=n=>n&&typeof n=="object";return t.reduce((n,a)=>(Object.keys(a).forEach(i=>{const l=n[i],r=a[i];if(Array.isArray(l)&&Array.isArray(r)){n[i]=l.concat(...r);return}if(e(l)&&e(r)){n[i]=$(l,r);return}r!==void 0&&(n[i]=r)}),n),{})},C=(t,e,n)=>{var a,i;const l=!!t.dataset.glitched;let r,s;if(!l)s=document.createElement("div"),s.style.display="grid",r=document.createElement("div"),getComputedStyle(t).getPropertyValue("display").match(/^inline/)&&(r.style.display="inline-block"),r.appendChild(s);else{for(s=t.parentElement,r=(a=t.parentElement)==null?void 0:a.parentElement;s.children.length>1;)s.removeChild(s.children[1]);s.firstElementChild.getAnimations().forEach(c=>c.cancel())}n.hideOverflow&&(r.style.overflow="hidden"),n.html&&(t.innerHTML=n.html),l||((i=t.parentElement)==null||i.insertBefore(r,t),s.prepend(t)),t.style.gridArea="1/1/-1/-1";const o=t.cloneNode(!0);o.style.gridArea="1/1/-1/-1",o.style.userSelect="none",o.style.pointerEvents="none",o.style.opacity="0";for(let c=0;c<e.length-1;++c){const h=o.cloneNode(!0);s.appendChild(h)}const d=()=>{e.forEach((c,h)=>{s.children[h].animate(c.steps,c.timing)})},m=()=>{e.forEach((c,h)=>{s.children[h].getAnimations().forEach(L=>{L.cancel()})})};switch(n.playMode){case"always":d(),r.onmouseenter=null,r.onmouseleave=null;break;case"hover":r.onmouseenter=d,r.onmouseleave=m,r.onclick=null;break;case"click":r.onmouseenter=null,r.onmouseleave=null,r.onclick=()=>{m(),d()};break;case"manual":r.onmouseenter=null,r.onmouseleave=null,r.onclick=null;break}return t.dataset.glitched="1",{container:r,startGlitch:d,stopGlitch:m}},H={glitch:(t=".powerglitch",e={})=>{const n=$(v(e.playMode),e);let a=[];typeof t=="string"?a=Array.from(document.querySelectorAll(t)):t instanceof NodeList?a=Array.from(t):Array.isArray(t)?a=t:t instanceof HTMLElement&&(a=[t]);const i=E(n),l=a.map(r=>C(r,i,n));return{containers:l.map(r=>r.container),startGlitch:()=>l.forEach(r=>r.startGlitch()),stopGlitch:()=>l.forEach(r=>r.stopGlitch())}},generateLayers:E,getDefaultOptions:v};f.PowerGlitch=H,Object.defineProperty(f,"__esModule",{value:!0})})(this.window=this.window||{});
