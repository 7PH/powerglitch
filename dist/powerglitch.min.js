(function(u){"use strict";var b=Object.defineProperty,E=Object.defineProperties,_=Object.getOwnPropertyDescriptors,f=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,d=(e,n,t)=>n in e?b(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,c=(e,n)=>{for(var t in n||(n={}))$.call(n,t)&&d(e,t,n[t]);if(f)for(var t of f(n))v.call(n,t)&&d(e,t,n[t]);return e},M=(e,n)=>E(e,_(n));const h=()=>({playMode:"always",backgroundColor:"transparent",hideOverflow:!1,timing:{duration:2*1e3,iterations:1/0},glitchTimeSpan:{start:.5,end:.7},shake:{velocity:15,amplitudeX:.4,amplitudeY:.4},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),m=(e,n)=>{let t=0;if(e.glitchTimeSpan){const r=e.glitchTimeSpan.start,s=e.glitchTimeSpan.end;if(n<r||n>s)return 0;const o=r+(s-r)/2;n<o?t=(n-r)/(o-r):t=(s-n)/(s-o)}else t=1;return(Math.random()-.5)*2*t},O=({minHeight:e,maxHeight:n,minWidth:t,maxWidth:l})=>{const r=Math.floor(Math.random()*((n-e)*100+1))+e*100,s=Math.floor(Math.random()*((l-t)*100+1))+t*100,o=Math.floor(Math.random()*(100-r)),a=Math.floor(Math.random()*(100-s));return{top:o,left:a,height:r,width:s}},P=({top:e,left:n,height:t,width:l})=>{const r=`${n+l}% ${e}%`,s=`${n+l}% ${e+t}%`,o=`${n}% ${e+t}%`,a=`${n}% ${e}%`;return`polygon(${r}, ${s}, ${o}, ${a})`},g=e=>M(c({},h().timing),{easing:`steps(${e}, jump-start)`}),C=e=>{if(!e.slice)throw new Error("Slice are not enabled");const n=Math.floor(e.slice.velocity*e.timing.duration/1e3)+1,t=[];for(let l=0;l<n;++l){const r=O({minHeight:e.slice.minHeight,maxHeight:e.slice.maxHeight,minWidth:1,maxWidth:1}),s=m(e,l/n)*30,o={};o.transform=`translate3d(${s}%, 0, 0)`,o.clipPath=P(r),e.slice.hueRotate&&(o.filter=`hue-rotate(${Math.floor(m(e,l/n)*360)}deg)`),t.push(o)}return{steps:t,timing:c(c({},g(n)),e.timing)}},k=e=>{if(!e.shake)return{steps:[],timing:g(1)};const n=Math.floor(e.shake.velocity*e.timing.duration/1e3)+1,t=[];for(let l=0;l<n;++l){const r=m(e,l/n)*e.shake.amplitudeX*100,s=m(e,l/n)*e.shake.amplitudeY*100,o={};o.transform=`translate3d(${r}%, ${s}%, 0)`,t.push(o)}return{steps:t,timing:c(c({},g(n)),e.timing)}},y=e=>{const n=[];if(n.push(k(e)),e.slice)for(let t=0;t<e.slice.count;++t)n.push(C(e));return n},p=(e,n,t,l)=>{const r=document.createElement("div");for(r.classList.add("layer"),r.style.backgroundColor=t.backgroundColor,r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="center",r.style.backgroundSize="contain",r.style.width="100%",r.style.height="100%",r.style.top="0",r.style.left="0",r.style.position="absolute",e.style.position="relative",t.hideOverflow?e.style.overflow="hidden":e.style.overflow="visible";e.firstChild;)e.removeChild(e.firstChild);for(let a=0;a<n.length;++a){const i=r.cloneNode(!1);i.style.backgroundImage=`url(${l})`,e.appendChild(i)}const s=()=>{n.forEach((a,i)=>e.children[i].animate(a.steps,a.timing))},o=()=>{n.forEach((a,i)=>e.children[i].getAnimations().map(L=>L.cancel()))};switch(t.playMode){case"always":s(),e.onmouseenter=null,e.onmouseleave=null;break;case"hover-triggered":e.onmouseenter=()=>{s(),e.onmouseenter=null},e.onmouseleave=null;break;case"hover-only":e.onmouseenter=s,e.onmouseleave=o;break}};function w(...e){const n=t=>t&&typeof t=="object";return e.reduce((t,l)=>(Object.keys(l).forEach(r=>{const s=t[r],o=l[r];if(Array.isArray(s)&&Array.isArray(o)){t[r]=s.concat(...o);return}if(n(s)&&n(o)){t[r]=w(s,o);return}o!==void 0&&(t[r]=o)}),t),{})}const A={glitch:(e=".powerglitch",n={})=>{const t=w(h(),n);let l=[];if(typeof e=="string"){const a=document.querySelectorAll(e);if(!a.length)throw new Error(`Could not find any element with selector ${e}`);l=Array.from(a)}else l=[e];const r=l.filter(a=>a instanceof HTMLImageElement),s=l.filter(a=>a instanceof HTMLDivElement),o=y(t);for(const a of r){const i=document.createElement("div");if(i.style.width=a.clientWidth+"px",i.style.height=a.clientHeight+"px",!a.parentElement)throw new Error("Unable to glitch image, it is not attached to a parent element");a.parentElement.insertBefore(i,a),a.remove(),p(i,o,t,t.imageUrl||a.src)}for(const a of s){if(!t.imageUrl)throw new Error("Options.imageUrl must be set if there are div elements to glitch");p(a,o,t,t.imageUrl)}},generateLayers:y,getDefaultOptions:h};u.PowerGlitch=A,Object.defineProperty(u,"__esModule",{value:!0})})(this.window=this.window||{});
