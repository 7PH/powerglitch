(function(u){"use strict";var b=Object.defineProperty,g=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable,f=(e,n,t)=>n in e?b(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,c=(e,n)=>{for(var t in n||(n={}))E.call(n,t)&&f(e,t,n[t]);if(g)for(var t of g(n))$.call(n,t)&&f(e,t,n[t]);return e};const d=(e="always")=>e==="always"?{playMode:e,backgroundColor:"transparent",hideOverflow:!1,timing:{duration:2*1e3,iterations:1/0},glitchTimeSpan:{start:.5,end:.7},shake:{velocity:15,amplitudeX:.4,amplitudeY:.4},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}:{playMode:e,backgroundColor:"transparent",hideOverflow:!1,timing:{duration:150,iterations:1},glitchTimeSpan:{start:0,end:1},shake:{velocity:15,amplitudeX:.05,amplitudeY:.05},slice:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}},m=(e,n)=>{let t=0;if(e.glitchTimeSpan){const r=e.glitchTimeSpan.start,i=e.glitchTimeSpan.end;if(n<r||n>i)return 0;const a=r+(i-r)/2;n<a?t=(n-r)/(a-r):t=(i-n)/(i-a)}else t=1;return(Math.random()-.5)*2*t},v=({minHeight:e,maxHeight:n,minWidth:t,maxWidth:l})=>{const r=Math.floor(Math.random()*((n-e)*100+1))+e*100,i=Math.floor(Math.random()*((l-t)*100+1))+t*100,a=Math.floor(Math.random()*(100-r)),o=Math.floor(Math.random()*(100-i));return{top:a,left:o,height:r,width:i}},M=({top:e,left:n,height:t,width:l})=>{const r=`${n+l}% ${e}%`,i=`${n+l}% ${e+t}%`,a=`${n}% ${e+t}%`,o=`${n}% ${e}%`;return`polygon(${r}, ${i}, ${a}, ${o})`},h=e=>({easing:`steps(${e}, jump-start)`}),_=e=>{if(!e.slice)throw new Error("Slice are not enabled");const n=Math.floor(e.slice.velocity*e.timing.duration/1e3)+1,t=[];for(let l=0;l<n;++l){const r=v({minHeight:e.slice.minHeight,maxHeight:e.slice.maxHeight,minWidth:1,maxWidth:1}),i=m(e,l/n)*30,a={};a.transform=`translate3d(${i}%, 0, 0)`,a.clipPath=M(r),e.slice.hueRotate&&(a.filter=`hue-rotate(${Math.floor(m(e,l/n)*360)}deg)`),t.push(a)}return{steps:t,timing:c(c({},h(n)),e.timing)}},C=e=>{if(!e.shake)return{steps:[],timing:h(1)};const n=Math.floor(e.shake.velocity*e.timing.duration/1e3)+1,t=[];for(let l=0;l<n;++l){const r=m(e,l/n)*e.shake.amplitudeX*100,i=m(e,l/n)*e.shake.amplitudeY*100,a={};a.transform=`translate3d(${r}%, ${i}%, 0)`,t.push(a)}return{steps:t,timing:c(c({},h(n)),e.timing)}},y=e=>{const n=[];if(n.push(C(e)),e.slice)for(let t=0;t<e.slice.count;++t)n.push(_(e));return n},w=(e,n,t,l)=>{const r=document.createElement("div");for(r.classList.add("layer"),r.style.backgroundColor=t.backgroundColor,r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="center",r.style.backgroundSize="contain",r.style.width="100%",r.style.height="100%",r.style.top="0",r.style.left="0",r.style.position="absolute",e.style.position="relative",t.hideOverflow?e.style.overflow="hidden":e.style.overflow="visible";e.firstChild;)e.removeChild(e.firstChild);for(let o=0;o<n.length;++o){const s=r.cloneNode(!1);s.style.backgroundImage=`url(${l})`,e.appendChild(s)}const i=()=>{n.forEach((o,s)=>e.children[s].animate(o.steps,o.timing))},a=()=>{n.forEach((o,s)=>e.children[s].getAnimations().map(O=>O.cancel()))};switch(t.playMode){case"always":i(),e.onmouseenter=null,e.onmouseleave=null;break;case"hover-triggered":e.onmouseenter=()=>{i(),e.onmouseenter=null},e.onmouseleave=null;break;case"hover-only":e.onmouseenter=i,e.onmouseleave=a;break}};function p(...e){const n=t=>t&&typeof t=="object";return e.reduce((t,l)=>(Object.keys(l).forEach(r=>{const i=t[r],a=l[r];if(Array.isArray(i)&&Array.isArray(a)){t[r]=i.concat(...a);return}if(n(i)&&n(a)){t[r]=p(i,a);return}a!==void 0&&(t[r]=a)}),t),{})}const k={glitch:(e=".powerglitch",n={})=>{const t=p(d(n.playMode),n);let l=[];if(typeof e=="string"){const o=document.querySelectorAll(e);if(!o.length)throw new Error(`Could not find any element with selector ${e}`);l=Array.from(o)}else l=[e];const r=l.filter(o=>o instanceof HTMLImageElement),i=l.filter(o=>o instanceof HTMLDivElement),a=y(t);for(const o of r){const s=document.createElement("div");if(s.style.width=o.clientWidth+"px",s.style.height=o.clientHeight+"px",!o.parentElement)throw new Error("Unable to glitch image, it is not attached to a parent element");o.parentElement.insertBefore(s,o),o.remove(),w(s,a,t,t.imageUrl||o.src)}for(const o of i){if(!t.imageUrl)throw new Error("Options.imageUrl must be set if there are div elements to glitch");w(o,a,t,t.imageUrl)}},generateLayers:y,getDefaultOptions:d};u.PowerGlitch=k,Object.defineProperty(u,"__esModule",{value:!0})})(this.window=this.window||{});
