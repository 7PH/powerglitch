(function(m){"use strict";var $=Object.defineProperty,g=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,y=(t,n,r)=>n in t?$(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,o=(t,n)=>{for(var r in n||(n={}))E.call(n,r)&&y(t,r,n[r]);if(g)for(var r of g(n))_.call(n,r)&&y(t,r,n[r]);return t};const v=(t="always")=>({playMode:t,hideOverflow:!1,timing:t==="always"?{duration:2*1e3,iterations:1/0}:{duration:250,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),u=(t,n)=>{let r=0;if(t.glitchTimeSpan){const s=t.glitchTimeSpan.start,e=t.glitchTimeSpan.end;if(n<s||n>e)return 0;const a=s+(e-s)/2;n<a?r=(n-s)/(a-s):r=(e-n)/(e-a)}else r=1;return(Math.random()-.5)*2*r},M=({minHeight:t,maxHeight:n,minWidth:r,maxWidth:i})=>{const s=Math.floor(Math.random()*((n-t)*100+1))+t*100,e=Math.floor(Math.random()*((i-r)*100+1))+r*100,a=Math.floor(Math.random()*(100-s)),c=Math.floor(Math.random()*(100-e));return{top:a,left:c,height:s,width:e}},A=({top:t,left:n,height:r,width:i})=>{const s=`${n+i}% ${t}%`,e=`${n+i}% ${t+r}%`,a=`${n}% ${t+r}%`,c=`${n}% ${t}%`;return`polygon(${s}, ${e}, ${a}, ${c})`},d=t=>({easing:`steps(${t}, jump-start)`}),b=t=>{const n=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,r=[];for(let i=0;i<n;++i){const s=M({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1}),e=u(t,i/n)*30,a={};a.transform=`translate3d(${e}%, 0, 0)`,a.clipPath=A(s),t.slice.hueRotate&&(a.filter=`hue-rotate(${Math.floor(u(t,i/n)*360)}deg)`),r.push(a)}return{steps:r,timing:o(o({},d(n)),t.timing)}},G=t=>{if(!t.shake)return{steps:[],timing:o(o({},d(1)),t.timing)};const n=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,r=[];for(let i=0;i<n;++i){const s=u(t,i/n)*t.shake.amplitudeX*100,e=u(t,i/n)*t.shake.amplitudeY*100,a={};a.transform=`translate3d(${s}%, ${e}%, 0)`,r.push(a)}return{steps:r,timing:o(o({},d(n)),t.timing)}},p=t=>{const n=[G(t)];if(t.slice)for(let r=0;r<t.slice.count;++r)n.push(b(t));return n},w=(...t)=>{const n=r=>r&&typeof r=="object";return t.reduce((r,i)=>(Object.keys(i).forEach(s=>{const e=r[s],a=i[s];if(Array.isArray(e)&&Array.isArray(a)){r[s]=e.concat(...a);return}if(n(e)&&n(a)){r[s]=w(e,a);return}a!==void 0&&(r[s]=a)}),r),{})},k=(t,n,r)=>{var i;const s=!!t.dataset.glitched;let e;if(!s)e=document.createElement("div"),e.style.display="grid";else{for(e=t.parentElement;e.children.length>1;)e.removeChild(e.children[1]);e.firstChild.getAnimations().forEach(l=>l.cancel())}r.hideOverflow&&(e.style.overflow="hidden"),r.html&&(t.innerHTML=r.html),s||((i=t.parentElement)==null||i.insertBefore(e,t),e.prepend(t)),t.style.gridArea="1 / 1 / -1 / -1";const a=t.cloneNode(!0);a.style.gridArea="1 / 1 / -1 / -1",a.style.userSelect="none",a.style.pointerEvents="none";for(let l=0;l<n.length-1;++l){const h=a.cloneNode(!0);e.appendChild(h)}const c=()=>{n.forEach((l,h)=>{e.children[h].animate(l.steps,l.timing)})},f=()=>{n.forEach((l,h)=>{e.children[h].getAnimations().forEach(L=>{L.cancel()})})};switch(r.playMode){case"always":c(),e.onmouseenter=null,e.onmouseleave=null;break;case"hover":e.onmouseenter=c,e.onmouseleave=f,e.onclick=null;break;case"click":e.onmouseenter=null,e.onmouseleave=null,e.onclick=()=>{f(),c()};break;case"manual":e.onmouseenter=null,e.onmouseleave=null,e.onclick=null;break}return t.dataset.glitched="1",{container:e,startGlitch:c,stopGlitch:f}},H={glitch:(t=".powerglitch",n={})=>{const r=w(v(n.playMode),n);let i=[];typeof t=="string"?i=Array.from(document.querySelectorAll(t)):t instanceof NodeList?i=Array.from(t):Array.isArray(t)?i=t:t instanceof HTMLElement&&(i=[t]);const s=p(r),e=i.map(a=>k(a,s,r));return{containers:e.map(a=>a.container),startGlitch:()=>e.forEach(a=>a.startGlitch()),stopGlitch:()=>e.forEach(a=>a.stopGlitch())}},generateLayers:p,getDefaultOptions:v};m.PowerGlitch=H,Object.defineProperty(m,"__esModule",{value:!0})})(this.window=this.window||{});
