(function(f){"use strict";var $=Object.defineProperty,m=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,g=(t,e,n)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,h=(t,e)=>{for(var n in e||(e={}))_.call(e,n)&&g(t,n,e[n]);if(m)for(var n of m(e))E.call(e,n)&&g(t,n,e[n]);return t};const y=(t="always")=>({playMode:t,hideOverflow:!1,timing:t==="always"?{duration:2*1e3,iterations:1/0}:{duration:150,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),u=(t,e)=>{let n=0;if(t.glitchTimeSpan){const s=t.glitchTimeSpan.start,r=t.glitchTimeSpan.end;if(e<s||e>r)return 0;const a=s+(r-s)/2;e<a?n=(e-s)/(a-s):n=(r-e)/(r-a)}else n=1;return(Math.random()-.5)*2*n},M=({minHeight:t,maxHeight:e,minWidth:n,maxWidth:i})=>{const s=Math.floor(Math.random()*((e-t)*100+1))+t*100,r=Math.floor(Math.random()*((i-n)*100+1))+n*100,a=Math.floor(Math.random()*(100-s)),o=Math.floor(Math.random()*(100-r));return{top:a,left:o,height:s,width:r}},b=({top:t,left:e,height:n,width:i})=>{const s=`${e+i}% ${t}%`,r=`${e+i}% ${t+n}%`,a=`${e}% ${t+n}%`,o=`${e}% ${t}%`;return`polygon(${s}, ${r}, ${a}, ${o})`},d=t=>({easing:`steps(${t}, jump-start)`}),A=t=>{if(!t.slice)throw new Error("Slice are not enabled");const e=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,n=[];for(let i=0;i<e;++i){const s=M({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1}),r=u(t,i/e)*30,a={};a.transform=`translate3d(${r}%, 0, 0)`,a.clipPath=b(s),t.slice.hueRotate&&(a.filter=`hue-rotate(${Math.floor(u(t,i/e)*360)}deg)`),n.push(a)}return{steps:n,timing:h(h({},d(e)),t.timing)}},P=t=>{if(!t.shake)return{steps:[],timing:d(1)};const e=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,n=[];for(let i=0;i<e;++i){const s=u(t,i/e)*t.shake.amplitudeX*100,r=u(t,i/e)*t.shake.amplitudeY*100,a={};a.transform=`translate3d(${s}%, ${r}%, 0)`,n.push(a)}return{steps:n,timing:h(h({},d(e)),t.timing)}},p=t=>{const e=[P(t)];if(t.slice)for(let n=0;n<t.slice.count;++n)e.push(A(t));return e},v=(...t)=>{const e=n=>n&&typeof n=="object";return t.reduce((n,i)=>(Object.keys(i).forEach(s=>{const r=n[s],a=i[s];if(Array.isArray(r)&&Array.isArray(a)){n[s]=r.concat(...a);return}if(e(r)&&e(a)){n[s]=v(r,a);return}a!==void 0&&(n[s]=a)}),n),{})},H=(t,e,n)=>{var i;const s=!!t.dataset.glitched;let r;if(!s)r=document.createElement("div"),r.style.display=getComputedStyle(t).getPropertyValue("display"),r.style.position="relative";else{for(r=t.parentElement;r.children.length>1;)r.removeChild(r.children[1]);r.firstChild.getAnimations().forEach(l=>l.cancel())}n.hideOverflow&&(r.style.overflow="hidden"),n.html&&(t.innerHTML=n.html),s||((i=t.parentElement)==null||i.insertBefore(r,t),r.prepend(t));const a=t.cloneNode(!0);a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.userSelect="none",a.style.pointerEvents="none";for(let l=0;l<e.length-1;++l){const c=a.cloneNode(!0);r.appendChild(c)}const o=()=>{e.forEach((l,c)=>r.children[c].animate(l.steps,l.timing))},w=()=>{e.forEach((l,c)=>r.children[c].getAnimations().map(R=>R.cancel()))};switch(n.playMode){case"always":o(),r.onmouseenter=null,r.onmouseleave=null;break;case"hover":r.onmouseenter=o,r.onmouseleave=w,r.onclick=null;break;case"click":r.onmouseenter=null,r.onmouseleave=null,r.onclick=()=>{w(),o()};break}t.dataset.glitched="1"},L={glitch:(t=".powerglitch",e={})=>{const n=v(y(e.playMode),e);let i=[];typeof t=="string"?i=Array.from(document.querySelectorAll(t)):t instanceof NodeList?i=Array.from(t):Array.isArray(t)?i=t:t instanceof HTMLElement&&(i=[t]);const s=p(n);i.forEach(r=>H(r,s,n))},generateLayers:p,getDefaultOptions:y};f.PowerGlitch=L,Object.defineProperty(f,"__esModule",{value:!0})})(this.window=this.window||{});
