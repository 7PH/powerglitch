(function(y){"use strict";var M=Object.defineProperty,p=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,v=(t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,o=(t,e)=>{for(var n in e||(e={}))b.call(e,n)&&v(t,n,e[n]);if(p)for(var n of p(e))A.call(e,n)&&v(t,n,e[n]);return t};const w=(t="always")=>({playMode:t,hideOverflow:!1,timing:t==="always"?{duration:2*1e3,iterations:1/0}:{duration:250,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),E=(t,e)=>{if(!t.glitchTimeSpan)return 1;const n=t.glitchTimeSpan.start,a=t.glitchTimeSpan.end;if(e<n||e>a)return 0;const i=n+(a-n)/2;return e<i?(e-n)/(i-n):(a-e)/(a-i)},d=(t,e)=>(Math.random()-.5)*2*E(t,e),G=({minHeight:t,maxHeight:e,minWidth:n,maxWidth:a})=>{const i=Math.floor(Math.random()*((e-t)*100+1))+t*100,l=Math.floor(Math.random()*((a-n)*100+1))+n*100,r=Math.floor(Math.random()*(100-i)),c=Math.floor(Math.random()*(100-l));return{top:r,left:c,height:i,width:l}},k=({top:t,left:e,height:n,width:a})=>{const i=`${e+a}% ${t}%`,l=`${e+a}% ${t+n}%`,r=`${e}% ${t+n}%`,c=`${e}% ${t}%`;return`polygon(${i}, ${l}, ${r}, ${c})`},f=t=>({easing:`steps(${t}, jump-start)`}),P=t=>{const e=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,n=[];for(let a=0;a<e;++a){if(E(t,a/e)===0){n.push({opacity:"0",transform:"",clipPath:"unset"});continue}const i=G({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1}),l=d(t,a/e)*30,r={opacity:"1",transform:`translate3d(${l}%, 0, 0)`,clipPath:k(i)};t.slice.hueRotate&&(r.filter=`hue-rotate(${Math.floor(d(t,a/e)*360)}deg)`),n.push(r)}return{steps:n,timing:o(o({},f(e)),t.timing)}},C=t=>{if(!t.shake)return{steps:[],timing:o(o({},f(1)),t.timing)};const e=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,n=[];for(let a=0;a<e;++a){const i=d(t,a/e)*t.shake.amplitudeX*100,l=d(t,a/e)*t.shake.amplitudeY*100,r={};r.transform=`translate3d(${i}%, ${l}%, 0)`,n.push(r)}return{steps:n,timing:o(o({},f(e)),t.timing)}},_=t=>{const e=[C(t)];if(t.slice)for(let n=0;n<t.slice.count;++n)e.push(P(t));return e},$=(...t)=>{const e=n=>n&&typeof n=="object";return t.reduce((n,a)=>(Object.keys(a).forEach(i=>{const l=n[i],r=a[i];if(Array.isArray(l)&&Array.isArray(r)){n[i]=l.concat(...r);return}if(e(l)&&e(r)){n[i]=$(l,r);return}r!==void 0&&(n[i]=r)}),n),{})},H=(t,e,n)=>{var a,i;const l=!!t.dataset.glitched;let r,c;if(!l)c=document.createElement("div"),c.style.display="grid",r=document.createElement("div"),getComputedStyle(t).getPropertyValue("display").match(/^inline/)&&(r.style.display="inline-block"),r.appendChild(c);else{for(c=t.parentElement,r=(a=t.parentElement)==null?void 0:a.parentElement;c.children.length>1;)c.removeChild(c.children[1]);c.firstElementChild.getAnimations().forEach(s=>s.cancel())}n.hideOverflow&&(r.style.overflow="hidden"),n.html&&(t.innerHTML=n.html),l||((i=t.parentElement)==null||i.insertBefore(r,t),c.prepend(t)),t.style.gridArea="1 / 1 / -1 / -1";const h=t.cloneNode(!0);h.style.gridArea="1 / 1 / -1 / -1",h.style.userSelect="none",h.style.pointerEvents="none",h.style.opacity="0";for(let s=0;s<e.length-1;++s){const u=h.cloneNode(!0);c.appendChild(u)}const m=()=>{e.forEach((s,u)=>{c.children[u].animate(s.steps,s.timing)})},g=()=>{e.forEach((s,u)=>{c.children[u].getAnimations().forEach(R=>{R.cancel()})})};switch(n.playMode){case"always":m(),r.onmouseenter=null,r.onmouseleave=null;break;case"hover":r.onmouseenter=m,r.onmouseleave=g,r.onclick=null;break;case"click":r.onmouseenter=null,r.onmouseleave=null,r.onclick=()=>{g(),m()};break;case"manual":r.onmouseenter=null,r.onmouseleave=null,r.onclick=null;break}return t.dataset.glitched="1",{container:r,startGlitch:m,stopGlitch:g}},L={glitch:(t=".powerglitch",e={})=>{const n=$(w(e.playMode),e);let a=[];typeof t=="string"?a=Array.from(document.querySelectorAll(t)):t instanceof NodeList?a=Array.from(t):Array.isArray(t)?a=t:t instanceof HTMLElement&&(a=[t]);const i=_(n),l=a.map(r=>H(r,i,n));return{containers:l.map(r=>r.container),startGlitch:()=>l.forEach(r=>r.startGlitch()),stopGlitch:()=>l.forEach(r=>r.stopGlitch())}},generateLayers:_,getDefaultOptions:w};y.PowerGlitch=L,Object.defineProperty(y,"__esModule",{value:!0})})(this.window=this.window||{});
