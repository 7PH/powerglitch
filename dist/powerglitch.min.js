(function(y){"use strict";var $=Object.defineProperty,p=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,v=(t,n,r)=>n in t?$(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,o=(t,n)=>{for(var r in n||(n={}))M.call(n,r)&&v(t,r,n[r]);if(p)for(var r of p(n))b.call(n,r)&&v(t,r,n[r]);return t};const w=(t="always")=>({playMode:t,hideOverflow:!1,timing:t==="always"?{duration:2*1e3,iterations:1/0}:{duration:250,iterations:1},glitchTimeSpan:t==="always"?{start:.5,end:.7}:{start:0,end:1},shake:{velocity:15,amplitudeX:.2,amplitudeY:.2},slice:t==="click"?{count:15,velocity:20,minHeight:.02,maxHeight:.15,hueRotate:!0}:{count:6,velocity:15,minHeight:.02,maxHeight:.15,hueRotate:!0}}),u=(t,n)=>{let r=0;if(t.glitchTimeSpan){const i=t.glitchTimeSpan.start,l=t.glitchTimeSpan.end;if(n<i||n>l)return 0;const e=i+(l-i)/2;n<e?r=(n-i)/(e-i):r=(l-n)/(l-e)}else r=1;return(Math.random()-.5)*2*r},A=({minHeight:t,maxHeight:n,minWidth:r,maxWidth:a})=>{const i=Math.floor(Math.random()*((n-t)*100+1))+t*100,l=Math.floor(Math.random()*((a-r)*100+1))+r*100,e=Math.floor(Math.random()*(100-i)),s=Math.floor(Math.random()*(100-l));return{top:e,left:s,height:i,width:l}},k=({top:t,left:n,height:r,width:a})=>{const i=`${n+a}% ${t}%`,l=`${n+a}% ${t+r}%`,e=`${n}% ${t+r}%`,s=`${n}% ${t}%`;return`polygon(${i}, ${l}, ${e}, ${s})`},f=t=>({easing:`steps(${t}, jump-start)`}),G=t=>{const n=Math.floor(t.slice.velocity*t.timing.duration/1e3)+1,r=[];for(let a=0;a<n;++a){const i=A({minHeight:t.slice.minHeight,maxHeight:t.slice.maxHeight,minWidth:1,maxWidth:1}),l=u(t,a/n)*30,e={};e.transform=`translate3d(${l}%, 0, 0)`,e.clipPath=k(i),t.slice.hueRotate&&(e.filter=`hue-rotate(${Math.floor(u(t,a/n)*360)}deg)`),r.push(e)}return{steps:r,timing:o(o({},f(n)),t.timing)}},C=t=>{if(!t.shake)return{steps:[],timing:o(o({},f(1)),t.timing)};const n=Math.floor(t.shake.velocity*t.timing.duration/1e3)+1,r=[];for(let a=0;a<n;++a){const i=u(t,a/n)*t.shake.amplitudeX*100,l=u(t,a/n)*t.shake.amplitudeY*100,e={};e.transform=`translate3d(${i}%, ${l}%, 0)`,r.push(e)}return{steps:r,timing:o(o({},f(n)),t.timing)}},E=t=>{const n=[C(t)];if(t.slice)for(let r=0;r<t.slice.count;++r)n.push(G(t));return n},_=(...t)=>{const n=r=>r&&typeof r=="object";return t.reduce((r,a)=>(Object.keys(a).forEach(i=>{const l=r[i],e=a[i];if(Array.isArray(l)&&Array.isArray(e)){r[i]=l.concat(...e);return}if(n(l)&&n(e)){r[i]=_(l,e);return}e!==void 0&&(r[i]=e)}),r),{})},P=(t,n,r)=>{var a,i;const l=!!t.dataset.glitched;let e,s;if(!l)s=document.createElement("div"),s.style.display="grid",e=document.createElement("div"),getComputedStyle(t).getPropertyValue("display").match(/^inline/)&&(e.style.display="inline-block"),e.appendChild(s);else{for(s=t.parentElement,e=(a=t.parentElement)==null?void 0:a.parentElement;s.children.length>1;)s.removeChild(s.children[1]);s.firstElementChild.getAnimations().forEach(c=>c.cancel())}r.hideOverflow&&(e.style.overflow="hidden"),r.html&&(t.innerHTML=r.html),l||((i=t.parentElement)==null||i.insertBefore(e,t),s.prepend(t)),t.style.gridArea="1 / 1 / -1 / -1";const d=t.cloneNode(!0);d.style.gridArea="1 / 1 / -1 / -1",d.style.userSelect="none",d.style.pointerEvents="none";for(let c=0;c<n.length-1;++c){const h=d.cloneNode(!0);s.appendChild(h)}const m=()=>{n.forEach((c,h)=>{s.children[h].animate(c.steps,c.timing)})},g=()=>{n.forEach((c,h)=>{s.children[h].getAnimations().forEach(L=>{L.cancel()})})};switch(r.playMode){case"always":m(),e.onmouseenter=null,e.onmouseleave=null;break;case"hover":e.onmouseenter=m,e.onmouseleave=g,e.onclick=null;break;case"click":e.onmouseenter=null,e.onmouseleave=null,e.onclick=()=>{g(),m()};break;case"manual":e.onmouseenter=null,e.onmouseleave=null,e.onclick=null;break}return t.dataset.glitched="1",{container:e,startGlitch:m,stopGlitch:g}},H={glitch:(t=".powerglitch",n={})=>{const r=_(w(n.playMode),n);let a=[];typeof t=="string"?a=Array.from(document.querySelectorAll(t)):t instanceof NodeList?a=Array.from(t):Array.isArray(t)?a=t:t instanceof HTMLElement&&(a=[t]);const i=E(r),l=a.map(e=>P(e,i,r));return{containers:l.map(e=>e.container),startGlitch:()=>l.forEach(e=>e.startGlitch()),stopGlitch:()=>l.forEach(e=>e.stopGlitch())}},generateLayers:E,getDefaultOptions:w};y.PowerGlitch=H,Object.defineProperty(y,"__esModule",{value:!0})})(this.window=this.window||{});
